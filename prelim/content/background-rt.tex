%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Radiation Transport}
\label{sec:bg:rt}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Much of the information in this section is paraphrased from Lewis \& Miller \cite{lewis_miller}.

%===============================================================================
\subsection{Transport Equation}
\label{sec:bg:rt:te}
%===============================================================================

%-------------------------------------------------------------------------------
\subsubsection{Particle Distributions}
\label{sec:bg:rt:te:pd}
%-------------------------------------------------------------------------------

In general, there are seven independent variables that are required to fully describe the distribution of neutrons: three coordinates specifying position ($\vec{r}$), two angles specifying the particle's direction of travel ($\hat{\Omega}$), the particle's energy ($E$), and time ($t$).

The most fundamental dependent variable in transport theory is the \textit{particle density distribution}.
The particle density distribution $N\left(\vec{r},\hat{\Omega},E,t\right)dEd\hat{\Omega}dV$ is defined as the number of particles in a volume element $dV$ about $\vec{r}$ traveling in the cone of directions $d\hat{\Omega}$ about $\hat{\Omega}$ with energies between $E$ and $E + dE$ at time $t$.

The particle density distribution is rarely directly considered in transport calculations, however.
The most common quantity considered is the \textit{angular flux}:
\begin{equation}\label{eq:bg:rt:angular-flux}
  \psi\left(\vec{r},\hat{\Omega},E,t\right) \equiv vN\left(\vec{r},\hat{\Omega},E,t\right)
\end{equation}
where $v$ is the particle speed.

It is sometimes useful to consider the flux independent of angle.
In these cases, the \textit{scalar flux} may be considered:
\begin{equation}\label{eq:bg:rt:scalar-flux}
  \phi\left(\vec{r},E,t\right) \equiv \int_{4\pi}\psi\left(\vec{r},\hat{\Omega},E,t\right)d\hat{\Omega}.
\end{equation}

The \textit{current vector}, which is a measure of the directionality of particles, is defined as
\begin{equation}\label{eq:bg:rt:current-vector}
  \vec{J}\left(\vec{r},E,t\right) \equiv \int_{4\pi}\psi\left(\vec{r},\hat{\Omega},E,t\right)\hat{\Omega} d\hat{\Omega}.
\end{equation}

The \textit{reaction rate} for reactions of type $x$ is
\begin{equation}\label{eq:bg:rt:rxn-rate-angular}
  R = \int_V\int_{4\pi}\int_0^\infty\sigma_x\left(\vec{r},\hat{\Omega},E\right)\psi\left(\vec{r},\hat{\Omega},E,t\right)dEd\hat{\Omega}dV
\end{equation}
where $\sigma_x$ is the cross section for reaction $x$.
Cross sections are almost always independent of the particle direction, so the reaction rate equation can be simplified as
\begin{equation}\label{eq:bg:rt:rxn-rate-scalar}
  R = \int_V\int_0^\infty\sigma_x\left(\vec{r},E\right)\phi\left(\vec{r},E,t\right)dEdV.
\end{equation}

If $\sigma_x$ refers to the total cross section $\sigma_t$, then the reaction rate is referred to as the \textit{collision density}.

%-------------------------------------------------------------------------------
\subsubsection{Transport Equation with General Source}
\label{sec:bg:rt:te:te}
%-------------------------------------------------------------------------------

The transport equation is a balance between all possible mechanisms for the number of particles in $dEd\hat{\Omega}dV$ to change.
There are three such mechanisms:
\begin{enumerate}
  \item net streaming out of $dV$, given by the streaming term $\hat{\Omega}\cdot\vec{\nabla}\psi\left(\vec{r},\hat{\Omega},E,t\right)$,
  \item collisions in $dV$ that result in particle absorption or scattering out of $dEdV$, given by the collision term $\sigma_t\left(\vec{r},E\right)\psi\left(\vec{r},\hat{\Omega},E,t\right)$, and
  \item emission of particles in $dV$ (includes external sources, scattering, and fission), given by a general source term $q\left(\vec{r},\hat{\Omega},E,t\right)$.
\end{enumerate}

The time-dependent transport equation is a balance between these three processes, and it is given by
\begin{equation}\label{eq:bg:rt:transport-totsrc-timedep}
  \frac{1}{v}\frac{\partial}{\partial t}\psi\left(\vec{r},\hat{\Omega},E,t\right) +
  \hat{\Omega}\cdot\vec{\nabla}\psi\left(\vec{r},\hat{\Omega},E,t\right) +
  \sigma_t\left(\vec{r},E\right)\psi\left(\vec{r},\hat{\Omega},E,t\right) =
  q\left(\vec{r},\hat{\Omega},E,t\right).
\end{equation}
If the dependence on time is neglected, the time-dependent term disappears. The time-independent transport equation is given by
\begin{equation}\label{eq:bg:rt:transport-totsrc}
  \hat{\Omega}\cdot\vec{\nabla}\psi\left(\vec{r},\hat{\Omega},E\right) +
  \sigma_t\left(\vec{r},E\right)\psi\left(\vec{r},\hat{\Omega},E\right) =
  q\left(\vec{r},\hat{\Omega},E\right).
\end{equation}

%-------------------------------------------------------------------------------
\subsubsection{Source Terms}
\label{sec:bg:rt:te:st}
%-------------------------------------------------------------------------------

The source term $q\left(\vec{r},\hat{\Omega},E,t\right)$ includes contributions from three sources: external sources, scattering, and fission.
It can be represented as a sum of these three contributions:
\begin{equation}\label{eq:bg:rt:source}
  q = q_{ex} + q_s + q_f.
\end{equation}

External sources are known distributions of source particles that are entirely independent of the flux.
External sources are represented as a known distribution $q_{ex}\left(\vec{r},\hat{\Omega},E,t\right)$.

Scattering sources are the result of particles scattering from one angle and energy to another.
Particles at the original angle and energy are removed from the system while particles at the new angle and energy are born.
The source due to scattering is given by the scattering term:
\begin{equation}\label{eq:bg:rt:scattering-term}
  q_s\left(\vec{r},\hat{\Omega},E,t\right) \equiv
  \int_{4\pi}\int_0^\infty\sigma_s\left(\vec{r},\hat{\Omega}^\prime\rightarrow\hat{\Omega},E^\prime\rightarrow E\right)\psi\left(\vec{r},\hat{\Omega}^\prime,E^\prime,t\right)dE^\prime d\hat{\Omega}^\prime
\end{equation}
where the scattering cross section $\sigma_s\left(\vec{r},\hat{\Omega}^\prime\rightarrow\hat{\Omega},E^\prime\rightarrow E\right)$ is the cross section for particles to scatter from $\hat{\Omega}^\prime$ into $\hat{\Omega}$ and $E^\prime$ into $E$.

Fission sources only occur if a multiplying medium exists in the system.
Fission sources will not be considered in this work.

%-------------------------------------------------------------------------------
\subsubsection{Transport Equation with Explicit Scattering Source}
\label{sec:bg:rt:te:te2}
%-------------------------------------------------------------------------------

Separating the total source term in the time-independent transport equation into its external and scattering components yields
\begin{multline}\label{eq:bg:rt:transport-timedep}
  \frac{1}{v}\frac{\partial}{\partial t}\psi\left(\vec{r},\hat{\Omega},E,t\right) +
  \hat{\Omega}\cdot\vec{\nabla}\psi\left(\vec{r},\hat{\Omega},E,t\right) +
  \sigma_t\left(\vec{r},E\right)\psi\left(\vec{r},\hat{\Omega},E,t\right) = \\
  \int_{4\pi}\int_0^\infty\sigma_s\left(\vec{r},\hat{\Omega}^\prime\rightarrow\hat{\Omega},E^\prime\rightarrow E\right)\psi\left(\vec{r},\hat{\Omega}^\prime,E^\prime,t\right)dE^\prime d\hat{\Omega}^\prime +
  q\left(\vec{r},\hat{\Omega},E,t\right).
\end{multline}
The time-independent version is given by 
\begin{multline}\label{eq:bg:rt:transport}
  \hat{\Omega}\cdot\vec{\nabla}\psi\left(\vec{r},\hat{\Omega},E\right) +
  \sigma_t\left(\vec{r},E\right)\psi\left(\vec{r},\hat{\Omega},E\right) = \\
  \int_{4\pi}\int_0^\infty\sigma_s\left(\vec{r},\hat{\Omega}^\prime\rightarrow\hat{\Omega},E^\prime\rightarrow E\right)\psi\left(\vec{r},\hat{\Omega}^\prime,E^\prime\right)dE^\prime d\hat{\Omega}^\prime +
  q\left(\vec{r},\hat{\Omega},E\right).
\end{multline}

%-------------------------------------------------------------------------------
\subsubsection{Operator Notation}
\label{sec:bg:rt:te:on}
%-------------------------------------------------------------------------------

It is often useful to write the transport equation in operator notation.
In this case, the time-independent \textit{transport operator} $H$ operates on the angular flux $\psi$ and is given by
\begin{multline}\label{eq:bg:rt:transport-operator}
  H\psi \equiv
  \hat{\Omega}\cdot\vec{\nabla}\psi\left(\vec{r},\hat{\Omega},E\right) +
  \sigma_t\left(\vec{r},E\right)\psi\left(\vec{r},\hat{\Omega},E\right) - \\
  \int_{4\pi}\int_0^\infty\sigma_s\left(\vec{r},\hat{\Omega}^\prime\rightarrow\hat{\Omega},E^\prime\rightarrow E\right)\psi\left(\vec{r},\hat{\Omega}^\prime,E^\prime\right)dE^\prime d\hat{\Omega}^\prime.
\end{multline}
The transport equation in operator notation is then simply
\begin{equation}\label{eq:bg:rt:transport-opnot}
  H\psi = q.
\end{equation}

%===============================================================================
\subsection{Adjoint Transport}
\label{sec:bg:rt:at}
%===============================================================================

Given an operator $H$ and the functions $\zeta$ and $\zeta^+$, the adjoint operator $H^+$ is defined by the \textit{adjoint identity}
\begin{equation}\label{eq:bg:rt:adjoint-identity}
  \left<\zeta^+H\zeta\right> =
  \left<\zeta H^+\zeta^+\right>,
\end{equation}
where $\left<\right>$ denotes integration over all independent variables.

It is often useful to consider adjoint transport, as distinct from forward (regular) transport.
An adjoint transport operator $H^+$ exists which satisfies the adjoint identity and operates on the \textit{adjoint flux} $\psi^+$.
The adjoint transport equation in operator notation is
\begin{equation}\label{eq:bg:rt:adjtransport-opnot}
  H^+\psi^+ = q^+,
\end{equation}
where $q^+$ is the adjoint source.
It is most useful to define the adjoint source as some detector response in the forward system.

Adjoint transport can be thought of as running in reverse when compared to forward transport.
In a system with a source and a detector, particles stream outward from the source and a response is calculated at the detector.
Adjoint particles, however, stream outward from the detector and a response is calculated at the source.
Adjoint particles also undergo scattering in reverse, gaining energy through scattering instead of losing energy.

There is a physical interpretation of the adjoint flux: the adjoint flux at a point is equal to the \textit{importance} of particles emitted at that point to the detector response.
In other words, the adjoint flux at some location $\vec{r}_0, \hat{\Omega}_0, E_0$ indicates how much a source at that location would contribute to the detector response.

The time-independent adjoint operator $H^+$ operates on the adjoint angular flux $\psi^+$ and is given by
\begin{multline}\label{eq:bg:rt:transport-operator}
  H^+\psi^+ \equiv
  -\hat{\Omega}\cdot\vec{\nabla}\psi^+\left(\vec{r},\hat{\Omega},E\right) +
  \sigma_t\left(\vec{r},E\right)\psi^+\left(\vec{r},\hat{\Omega},E\right) - \\
  \int_{4\pi}\int_0^\infty\sigma_s\left(\vec{r},\hat{\Omega}\rightarrow\hat{\Omega}^\prime,E\rightarrow E^\prime\right)\psi^+\left(\vec{r},\hat{\Omega}^\prime,E^\prime\right)dE^\prime d\hat{\Omega}^\prime.
\end{multline}

After expanding the adjoint transport operator, the adjoint transport equation is given by
\begin{multline}\label{eq:bg:rt:adjoint-transport}
  -\hat{\Omega}\cdot\vec{\nabla}\psi^+\left(\vec{r},\hat{\Omega},E\right) +
  \sigma_t\left(\vec{r},E\right)\psi^+\left(\vec{r},\hat{\Omega},E\right) = \\
  \int_{4\pi}\int_0^\infty\sigma_s\left(\vec{r},\hat{\Omega}\rightarrow\hat{\Omega}^\prime,E\rightarrow E^\prime\right)\psi^+\left(\vec{r},\hat{\Omega}^\prime,E^\prime\right)dE^\prime d\hat{\Omega}^\prime +
  q^+\left(\vec{r},\hat{\Omega},E\right).
\end{multline}

The detector response $R$ can be calculated in two ways:
\begin{equation}\label{eq:bg:rt:detector-response}
  R = \left<\psi,q^+\right>
    = \left<\psi^+,q\right>.
\end{equation}

%===============================================================================
\subsection{Adjoint and Combined Particle Distributions}
\label{sec:bg:rt:at:apd}
%===============================================================================

Several important particle distributions that exist in forward transport also exist in adjoint transport.
The adjoint scalar flux is defined as
\begin{equation}\label{eq:bg:rt:scalar-flux}
  \phi^+\left(\vec{r},E,t\right) \equiv
  \int_{4\pi}\psi^+\left(\vec{r},\hat{\Omega},E,t\right)d\hat{\Omega}.
\end{equation}
The adjoint current vector is defined as
\begin{equation}\label{eq:bg:rt:current-vector}
  \vec{J}^+\left(\vec{r},E,t\right) \equiv
  \int_{4\pi}\psi^+\left(\vec{r},\hat{\Omega},E,t\right)\hat{\Omega} d\hat{\Omega}.
\end{equation}

There are also some distributions that combine both the forward and adjoint flux.
The angular \textit{contributon flux} is defined as the product of the forward and adjoint angular fluxes:
\begin{equation}\label{eq:bg:rt:angular-contributon}
  \psi_{contrib}\left(\vec{r},\hat{\Omega},E,t\right) \equiv
  \psi\left(\vec{r},\hat{\Omega},E,t\right)\psi^+\left(\vec{r},-\hat{\Omega},E,t\right).
\end{equation}
The scalar contributon flux is obtained by integrating the angular contribution flux over angle:
\begin{equation}\label{eq:bg:rt:angular-contributon}
  \phi_{contrib}\left(\vec{r},E,t\right) \equiv
  \int_{4\pi}\psi\left(\vec{r},\hat{\Omega},E,t\right)\psi^+\left(\vec{r},-\hat{\Omega},E,t\right)d\hat{\Omega}.
\end{equation}
Note that this is not the same quantity as the product of the forward and adjoint scalar fluxes. It is important to integrate over energy after multiplying the forward and angular fluxes, not before.
