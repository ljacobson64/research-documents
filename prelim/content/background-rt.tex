%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Radiation Transport}
\label{sec:bg:rt}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Placeholder

%===============================================================================
\subsection{Transport Equation}
\label{sec:bg:rt:te}
%===============================================================================

In transport calculations, neutrons have four distinguishing characteristics: position ($\vec{r}$), direction ($\hat{\Omega}$), energy ($E$), and time ($t$).
There are three components of position, two components of direction, and one component of energy and time, for a total of seven components.
Any neutrons that have the same values of these seven components are indistinguishable.

These seven components form a seven-dimensional phase space.
The quantity that describes how the neutrons are distributed within this phase space is referred to as the angular flux $\psi\left(\vec{r},\hat{\Omega},E,t\right)$.
The angular flux defines the number of neutrons that exist at point $\vec{r}$, going in direction ${\hat{\Omega}}$, with energy $E$, at time $t$.

The angular flux can be calculated by solving the transport equation, which is a balance equation that conserves neutrons.
Each term in the equation represents a net gain or loss of neutrons in all regions of phase space.
The transport equation is given by

\begin{multline}\label{eq:bg:rt:transport-timedep}
  \frac{1}{v}\frac{\partial}{\partial t}\psi\left(\vec{r},\hat{\Omega},E,t\right) +
  \hat{\Omega}\cdot\vec{\nabla}\psi\left(\vec{r},\hat{\Omega},E,t\right) +
  \sigma_t\left(\vec{r},E\right)\psi\left(\vec{r},\hat{\Omega},E,t\right) - \\
  \int_0^\infty\int_{4\pi}\sigma_s\left(\vec{r},\hat{\Omega}^\prime\rightarrow\hat{\Omega},E^\prime\rightarrow E\right)\psi\left(\vec{r},\hat{\Omega}^\prime,E^\prime,t\right)d\hat{\Omega}^\prime dE^\prime =
  q\left(\vec{r},\hat{\Omega},E,t\right).
\end{multline}

The streaming term $\hat{\Omega}\cdot\vec{\nabla}\psi\left(\vec{r},\hat{\Omega},E,t\right)$
represents the net removal of neutrons in a region of phase space due to streaming in the $\hat{\Omega}$ direction.

The collision term $\sigma_t\left(\vec{r},E\right)\psi\left(\vec{r},\hat{\Omega},E,t\right)$
represents the net removal of neutrons in a region of phase space due to them undergoing collisions.
The quantity $\sigma_t\left(\vec{r},E\right)$ is the total cross section, which is a measure of the probability that a neutron will undergo any possible interaction.

The scattering term $\int_0^\infty\int_{4\pi}\sigma_s\left(\vec{r},\hat{\Omega}^\prime\rightarrow\hat{\Omega},E^\prime\rightarrow E\right)\psi\left(\vec{r},\hat{\Omega}^\prime,E^\prime,t\right)d\hat{\Omega}^\prime dE^\prime$
represents the net gain of neutrons in a region of phase space due to scattering.
The quantity $\sigma_s\left(\vec{r},\hat{\Omega}^\prime\rightarrow\hat{\Omega},E^\prime\rightarrow E\right)$ is the scattering cross section,
which is a measure of the probability of a neutron scattering from angle $\hat{\Omega}^\prime$ into angle ${\hat{\Omega}}$ and energy $E^\prime$ into energy $E$.
The term is integrated over $\hat{\Omega}^\prime$ and $E^\prime$ to result in a quantity that includes contributions from all possible starting angles and energies.

The source term $q\left(\vec{r},\hat{\Omega},E,t\right)$
represents the gain of neutrons in a region of phase space from external sources.
It is usually a prescribed quantity.

In problems with no time dependence, the time-dependent term can be removed from the transport equation,
and the angular flux is represented in six-dimensional phase space as $\psi\left(\vec{r},\hat{\Omega},E\right)$.
The time-independent transport equation is given by

\begin{multline}\label{eq:bg:rt:transport}
  \hat{\Omega}\cdot\vec{\nabla}\psi\left(\vec{r},\hat{\Omega},E\right) +
  \sigma_t\left(\vec{r},E\right)\psi\left(\vec{r},\hat{\Omega},E\right) - \\
  \int_0^\infty\int_{4\pi}\sigma_s\left(\vec{r},\hat{\Omega}^\prime\rightarrow\hat{\Omega},E^\prime\rightarrow E\right)\psi\left(\vec{r},\hat{\Omega}^\prime,E^\prime\right)d\hat{\Omega}^\prime dE^\prime =
  q\left(\vec{r},\hat{\Omega},E\right).
\end{multline}

% TO REFERENCE: \ref{eq:bg:rt:transport}

The transport equation is sometimes written in operator notation, where the streaming, collision, and scattering terms are all combined into a single term known as the transport operator $H$.
The transport equation is written in operator notation simply as

\begin{equation}\label{eq:bg:rt:transport-operator}
  H\psi = q.
\end{equation}

There are two main classes of methods for solving the transport equation: Monte Carlo methods and deterministic methods.
These methods will be explored in Sections \ref{sec:bg:rt:mc} and \ref{sec:bg:rt:determ}.

%===============================================================================
\subsection{Adjoint Transport Equation}
\label{sec:bg:rt:adjoint}
%===============================================================================

In radiation transport, it is often useful to consider the concept of the ''adjoint'' flux.
Consider a standard problem with a source and a detector.
In the forward system, particles stream outward from the source and a response is calculated at the detector.
In the adjoint system, particles instead stream outward from the detector and a response is calculated at the source.
The forward detector is thus the same thing as the "adjoint source," and the forward source is thus the same thing as the "adjoint detector."

The reason the adjoint flux is useful is that if the adjoint source is defined to be some quantity of interest in the forward system, then the adjoint flux in a region of phase space can be through of as the importance of that region of phase space to the quantity of interest.
In other words, if a forward source is placed at some location, the adjoint flux at that location will indicate how much that source will contribute to the detector response.

The adjoint transport equation in operator notation is given by

\begin{equation}\label{eq:bg:rt:adjoint-transport-operator}
  H^+\psi^+ = q^+
\end{equation}

where $H^+$ is the adjoint transport operator, $\psi^+$ is the adjoint flux, and $q^+$ is the adjoint source.
$H^+$ is defined in such a way that $H$ and $H^+$ are adjoint to each other, and this property means the adjoint identity

\begin{equation}\label{eq:bg:rt:adjoint-identity}
  \left<\psi,q^+\right> =
  \left<\psi^+,q\right>,
\end{equation}

where $\left<\right>$ represents integration over all independent variables, holds.

After expanding the adjoint transport operator, the adjoint transport equation is given by

\begin{multline}\label{eq:bg:rt:adjoint-transport}
  -\hat{\Omega}\cdot\vec{\nabla}\psi^+\left(\vec{r},\hat{\Omega},E\right) +
  \sigma_t\left(\vec{r},E\right)\psi^+\left(\vec{r},\hat{\Omega},E\right) - \\
  \int_0^\infty\int_{4\pi}\sigma_s\left(\vec{r},\hat{\Omega}\rightarrow\hat{\Omega}^\prime,E\rightarrow E^\prime\right)\psi^+\left(\vec{r},\hat{\Omega}^\prime,E^\prime\right)d\hat{\Omega}^\prime dE^\prime =
  q^+\left(\vec{r},\hat{\Omega},E\right).
\end{multline}

If the adjoint source is defined to be the same as the forward detector, then the detector response $R$ can be calculated as

\begin{equation}\label{eq:bg:rt:detector-response}
  R = \left<\psi,q^+\right>
    = \left<\psi^+,q\right>.
\end{equation}

% Current, contributon flux, etc.

%===============================================================================
\subsection{Monte Carlo Methods}
\label{sec:bg:rt:mc}
%===============================================================================

There are two main classes of methods for solving the transport equation: Monte Carlo methods and deterministic methods.
The Monte Carlo method is a stochastic method which involves simulating individual particles and inferring results from their average behavior.
It allows for detailed representations of geometry and continuous energy and angle space.
However, it is quite compuationally expensive because many particles may need to be simulated in order to achieve reliable results.

%-------------------------------------------------------------------------------
\subsubsection{MCNP}
\label{sec:bg:rt:mc:MCNP}
%-------------------------------------------------------------------------------

The \ac{mcnp} transport code \cite{mcnp620} is a powerful and widely-used parallel Monte Carlo code developed at Los Alamos National Laboratory.
It is used for many applications, including "radiation protection and dosimetry, radiation shielding, radiography, medical physics, nuclear criticality safety, detector design and analysis, nuclear oil well logging, accelerator target design, fission and fusion reactor design, decontamination, and decommissioning" (quote from MCNP's website.)

%===============================================================================
\subsection{Deterministic Methods}
\label{sec:bg:rt:determ}
%===============================================================================

Deterministic methods solve the transport equation directly and produce detailed solutions throughout the entire phase space.
However, in order to do this, they must first discretize the geometry, angles, and energy space, and this discretization introduces uncertainities in the results.
Additionally, they may exhibit non-physical features such as ray effects and negative fluxes.
Hence, it requires a significant degree of expertise and insight to mitigate these undesirable characteristics and produce useful results.

The main advantage of deterministic methods when compared to Monte Carlo methods is that they are significantly less compuationally expensive.

Denovo \cite{denovo} is a powerful parallel 3D deterministic code developed at Oak Ridge National Laboratory.
It uses the discrete ordinates (S\textsubscript{N}), multigroup energy, and anisotropic P\textsubscript{n} approximations.
It can solve both the forward and adjoint transport equations.
It has several spatial discretization algorithms and angle quadrature sets.

%-------------------------------------------------------------------------------
\subsubsection{ADVANTG}
\label{sec:bg:rt:determ:advantg}
%-------------------------------------------------------------------------------

The easiest way to run Denovo calculations is with the \ac{advantg} \cite{advantg}, which is also developed at Oak Ridge National Laboratory.
The main purpose of ADVANTG is to generate variance reduction parameters for use in Monte Carlo simulations, but it can also be used to run Denovo without calculating variance reduction parameters.
Here are the main steps involved when using ADVANTG to drive a deterministic calculation:

\begin{itemize}
  \item Extract the geometry, materials, sources, and tallies from the MCNP model
  \item Discretize the geometry, sources, and tallies to conform to a user-supplied spatial grid and multigroup cross section library
  \item Mix the materials togetherso that each mesh element contains just one material
  \item Execute Denovo (forward, adjoint, or both)
  \item Write output to file
\end{itemize}

The main outputs of ADVANTG when it it is used to drive deterministic calculations are Silo files \cite{silo}.
These files contain the spatial grid, the mixed materials, sources, and tallies mapped onto the grid, thte scalar forward and adjoint fluxes, and the contributon flux.
The data contained in the Silo files can be visualized easily with the VisIT software \cite{visit}.

There are no documented user options which allow users to access the forward or adjoint angular flux data.
However, ADVANTG contains an undocumented feature which allows for the full angular data to be written to an HDF5 file \cite{hdf5}.

%===============================================================================
\subsection{Variance Reduction and Hybrid Methods}
\label{sec:bg:rt:vr}
%===============================================================================
